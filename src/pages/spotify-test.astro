---
// Simple Spotify auth test page
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Spotify Test</title>
  </head>
  <body>
    <h1>Spotify Authentication Test</h1>
    <p>This page will help debug the Spotify authentication issue.</p>
    
    <div id="debug-info">
      <h2>Debug Information:</h2>
      <div id="client-id"></div>
      <div id="redirect-uri"></div>
      <div id="auth-url"></div>
    </div>
    
    <button id="test-implicit">Test Implicit Grant (response_type=token)</button>
    <button id="test-code">Test Authorization Code (response_type=code)</button>
    
    <script>
      const SPOTIFY_CLIENT_ID = '14bd95608ea1475a8e8ce783fb072e53';
      const SPOTIFY_REDIRECT_URI = window.location.origin + '/spotify-callback';
      const SPOTIFY_SCOPES = 'streaming user-read-email user-read-private';
      
      // Display debug info
      document.getElementById('client-id').textContent = `Client ID: ${SPOTIFY_CLIENT_ID}`;
      document.getElementById('redirect-uri').textContent = `Redirect URI: ${SPOTIFY_REDIRECT_URI}`;
      
      // Test implicit grant (what we need for Web Playback SDK)
      const implicitUrl = `https://accounts.spotify.com/authorize?client_id=${SPOTIFY_CLIENT_ID}&response_type=token&redirect_uri=${encodeURIComponent(SPOTIFY_REDIRECT_URI)}&scope=${encodeURIComponent(SPOTIFY_SCOPES)}`;
      
      // Test authorization code flow (fallback)
      const codeUrl = `https://accounts.spotify.com/authorize?client_id=${SPOTIFY_CLIENT_ID}&response_type=code&redirect_uri=${encodeURIComponent(SPOTIFY_REDIRECT_URI)}&scope=${encodeURIComponent(SPOTIFY_SCOPES)}`;
      
      document.getElementById('auth-url').innerHTML = `
        <strong>Implicit Grant URL:</strong><br>
        <a href="${implicitUrl}" target="_blank">${implicitUrl}</a><br><br>
        <strong>Code Grant URL:</strong><br>
        <a href="${codeUrl}" target="_blank">${codeUrl}</a>
      `;
      
      document.getElementById('test-implicit').addEventListener('click', function() {
        console.log('Testing implicit grant...');
        console.log('Auth URL:', implicitUrl);
        window.location.href = implicitUrl;
      });
      
      document.getElementById('test-code').addEventListener('click', function() {
        console.log('Testing authorization code...');
        console.log('Auth URL:', codeUrl);
        window.location.href = codeUrl;
      });
    </script>
  </body>
</html>