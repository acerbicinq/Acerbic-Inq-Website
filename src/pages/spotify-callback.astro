---
// Dedicated Spotify OAuth callback page
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Spotify Authentication</title>
  </head>
  <body>
    <h1>Spotify Authentication</h1>
    <p id="status">Processing Spotify authentication...</p>
    
    <script>
      // Handle Spotify OAuth callback
      const hash = window.location.hash.substring(1);
      const params = new URLSearchParams(hash);
      const accessToken = params.get('access_token');
      const error = params.get('error');
      
      if (error) {
        document.getElementById('status').textContent = `Authentication failed: ${error}`;
        console.error('Spotify auth error:', error);
      } else if (accessToken) {
        // Store the token
        localStorage.setItem('spotify_access_token', accessToken);
        document.getElementById('status').textContent = 'Authentication successful! Redirecting...';
        
        // Redirect back to podcast page
        const returnUrl = localStorage.getItem('spotify_return_url') || '/podcast';
        setTimeout(() => {
          window.location.href = returnUrl;
        }, 2000);
      } else {
        document.getElementById('status').textContent = 'No authentication data received';
      }
    </script>
  </body>
</html>